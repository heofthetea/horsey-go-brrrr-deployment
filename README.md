# horsey-go-brrrr

This is where a central deployment resides to run the horsey-go-brrrr project.<br>
The horsey-go-brrrr project is a connect-4 game developed in the scope of the lecture "Web-Engineering II" at dhbw. It comprises of:

- [https://github.com/heofthetea/horsey-go-brrrr-be](https://github.com/heofthetea/horsey-go-brrrr-be) - a quarkus REST api
- [https://github.com/heofthetea/horsey-go-brrrr-fe](https://github.com/heofthetea/horsey-go-brrrr-fe) - a Vue.js application serving as an indepentend client

Splitting the project up this way is a deliberate choice based on the game architecture, where multiple logically independent client application communicate with a central server.

## About

Initially, horsey-go-brrrr was intended to be a chess multiplayer game. This would have been perfectly in scope with a development team of 2, as was initially the case. However due to the unfortunate circumstance of our beloved Josia dropping out, the development team was effectively halved and a full chess application with large amount of functionality became out of scope.<br>
&nbsp;&nbsp;&nbsp;&nbsp;
In order to reduce scope, the game implemented has been reduced from chess to connect-4, with reasoning being that the _technical_ scope (i.e. protocols etc.) remains the same, but the overhead generated by move validation is reduced. Also, Quality of Life features that are irrelevant to the central game flow have not been prioritized.<br>

### Scope
As part of this application, users can:
- Log in/register to a Keycloak Identity Provider
- Create connect-four games of variable board dimensions
- Invite other users to join a game through a link
- Play a game with real-time, web-socket based updates
- view all their games in a history bar
- For every game, view the move history, as well as who won on which square

> **Note**: As a personal challenge, I wanted to deploy the app into a cloud [https://horsey.francecentral.cloudapp.azure.com](https://horsey.francecentral.cloudapp.azure.com) (note: the VM is not guaranteed to be running at all times). While this is out of scope for the requirements set to the projects by the Module 'Web Engineering II', I nevertheless want to highlight this for potential consideration in grading.


### More Information
More documentation about system architecture can be found in the [API](https://github.com/heofthetea/horsey-go-brrrr-be) project.<br>


## Deployment

This project provides two docker compose files:

1. `docker-compose-azure.yml`: This is the compose file used to deploy the application onto the cloud 
2. `docker-compose.yml`: This is the file that should be used for local testing

> **Note**: The compose files differs fundamentally in architecture due to different requirements. In the cloud, only ports 443 and 80 are exposable, requiring a reverse proxy and HTTPS support for the Identity Provider. Locally, the compose files uses `network_mode: host` on one container to get around the issue of issuer mismatch errors caused by the IdP being accessible under tifferent IP addresses for the user and the API respectively.

### Local environment
#### Requirements
- Docker and Docker Compose installed
- Active internet connection to pull necessary docker containers from docker hub

#### Run
For local testing, please run the **local** docker compose file:
```bash
docker compose up -d
```

The following should be provided:

- A keycloak accessible under `localhost:8081`
  - the keycloak will have a fully configured realm, with the following two testing users:
    - username: `test1`, password: `test`
    - username: `test2`, password: `test`
- The Vue.js app accessible under `localhost:15173`

> **Info**: It is theoretically possible to play a game with oneself (i.e. using the same user as guest and host), however some of the apps functionality is better represented by playing with two different users.

### Recommended first testing
1. navigate to `localhost:15173`
2. in the login form, login as `test1` user
3. create a game
4. open a new private browser window
5. paste the game invite url
6. login as `test2`
7. start playing the game

> **Warning** Use with headphones is not recommended.

## Repository tour

In addition to the two docker compose files, this particular repository contains further configuration files:

- `keycloak/`: This directory holds JSON files which are loaded into the Keycloak IDP to configure the default clients and users.
- `nginx.conf`: This is the nginx config used on the "production" azure system
- `postgres/`: This directory contains a script to create multiple database on DBMS startup
